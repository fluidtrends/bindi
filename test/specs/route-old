var savor = require("savor")
var route = savor.src("route")
var server = savor.src("server")
var request = require("supertest")

function newServerInstance(routes) {
    var newServer = new server({
        port: 8888
    })
    newServer.addRoutes(routes)
    return newServer.start()
}

function newServerRoute(type, payload) {
    var newRoute = new route({})
    newRoute.mount(type, payload)
    return newRoute
}

savor.add("should be able to create a route", (context, done) => {
    var routes = [newServerRoute('get', {
        message: "hello"
    })]
    request(newServerInstance(routes)).
    get('/ddddd').
    end((err, res) => {
        context.expect(res.statusCode).to.equal(404)
        done()
    })
}).

run("Creating routes")
